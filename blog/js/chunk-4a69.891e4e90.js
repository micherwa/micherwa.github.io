(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4a69"],{"0CJ8":function(s,n,t){"use strict";t.r(n);var a={},v=t("psIG"),_=Object(v.a)(a,function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("div",{staticClass:"blog-container"},[a("BlogHeader"),s._v(" "),a("BlogContent",[a("div",{attrs:{slot:"content"},slot:"content"},[a("h2",[s._v("前言")]),s._v(" "),a("p",[s._v("\n                最近，朋友 L 问了我这样一个问题：以下数据的运算结果，为何会这样呈现？\n                "),a("pre",{staticClass:"hljs objectivec"},[a("code",{},[a("span",{staticClass:"hljs-number"},[s._v("0.55")]),s._v(" * "),a("span",{staticClass:"hljs-number"},[s._v("100")]),s._v(" "),a("span",{staticClass:"hljs-comment"},[s._v("// 55.00000000000001")]),a("br"),a("span",{staticClass:"hljs-number"},[s._v("0.56")]),s._v(" * "),a("span",{staticClass:"hljs-number"},[s._v("100")]),s._v(" "),a("span",{staticClass:"hljs-comment"},[s._v("// 56.00000000000001")]),a("br"),a("span",{staticClass:"hljs-number"},[s._v("0.57")]),s._v(" * "),a("span",{staticClass:"hljs-number"},[s._v("100")]),s._v(" "),a("span",{staticClass:"hljs-comment"},[s._v("// 56.99999999999999")]),a("br"),a("span",{staticClass:"hljs-number"},[s._v("0.58")]),s._v(" * "),a("span",{staticClass:"hljs-number"},[s._v("100")]),s._v(" "),a("span",{staticClass:"hljs-comment"},[s._v("// 57.99999999999999")]),a("br"),a("span",{staticClass:"hljs-number"},[s._v("0.59")]),s._v(" * "),a("span",{staticClass:"hljs-number"},[s._v("100")]),s._v(" "),a("span",{staticClass:"hljs-comment"},[s._v("// 59")]),a("br"),a("span",{staticClass:"hljs-number"},[s._v("0.60")]),s._v(" * "),a("span",{staticClass:"hljs-number"},[s._v("100")]),s._v(" "),a("span",{staticClass:"hljs-comment"},[s._v("// 60")])])]),s._v("\n                我虽然告诉了他这是由于浮点数精度问题导致的，但他还是不太明白，为何有的结果输出为整数，有的是以 ...001 的小数结尾，有的却是以 ...999 的小数结尾，跟预想中的有差异。\n            ")]),s._v(" "),a("p",[s._v("\n                这其实牵涉到了计算机原理的知识，真要解释清楚什么是浮点数，恐怕得分几个章节了，想深入了解的同学，可以前往 "),a("a",{attrs:{href:"https://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html",target:"_blank"}},[s._v("这篇文章")]),s._v(" 细读。今天我们仅讨论解释浮点数运算结果的成因，以及如何实现我们期望的结果。\n            ")]),s._v(" "),a("h2",[s._v("浮点数与 IEEE 754")]),s._v(" "),a("p",[s._v("\n                首先，计算机中的小数并不都叫浮点数。我们在写程序时，用到小数的地方，用 float 类型表示，可以方便快速地对小数进行运算。\n            ")]),s._v(" "),a("p",[s._v("\n                小数点在数制中代表一种对齐方式，比如说你要比较 1000 和 200 哪个比较大，该怎么做呢？必须把他们右对齐：\n                "),a("pre",{staticClass:"hljs"},[a("code",{},[s._v("1000"),a("br"),s._v(" 200")])]),s._v("\n                发现 1 比 0（前面补零）大，所以 1000 比较大。那么如果要比较 1000 和 200.01 呢？这时候就不是右对齐了，而应该是以小数点对齐：\n                "),a("pre",{staticClass:"hljs"},[a("code",{},[s._v("1000"),a("br"),s._v(" 200.01")])]),s._v("\n                小数点的位置，在进制表示中是至关重要的。位置差一位整体就要差进制倍（十进制就是十倍）。在计算机中也是这样，虽然计算机使用二进制，但在处理非整数时，也需要考虑小数点的位置问题。无法对齐小数点，就无法做加减法比较这样的操作。\n            ")]),s._v(" "),a("p",[s._v("\n                接下来的一个重要概念："),a("strong",[s._v("计算机中小数的表示法，其实有定点和浮点两种。")])]),s._v(" "),a("p",[s._v("\n                定点的意思是，小数点固定在 32 位中的某个位置，前面的是整数，后面的是小数。小数点具体固定在哪里，可以自己在程序中指定。定点数的优点是很简单，大部分运算实现起来和整数一样或者略有变化，但是缺点则是表示范围太小，精度很差，不能充分运用存储单元。\n            ")]),s._v(" "),a("p",[s._v("\n                浮点数就是设计来克服这个缺点的，它相当于一个定点数加上一个阶码，阶码表示将这个定点数的小数点移动若干位。由于可以用阶码移动小数点，因此称为浮点数。\n            ")]),s._v(" "),a("p",[s._v("\n                浮点数在 Javascript 中的存储，与其他语言如Java和Python不同。所有数字（包括整数和小数）都只有一种类型 — Number。它的实现遵循 IEEE 754 标准，使用64位精度来表示浮点数。它是目前最广泛使用的格式，该格式用 64 位二进制表示像下面这样：\n                "),a("img",{attrs:{src:t("u9/X")}}),s._v("\n                在 64 位中，1 位用于标志位，用来表示一个数是正数还是负数。11位用于指数，这允许指数最大到 1024。剩下的 52 位代表的是尾数。\n            ")]),s._v(" "),a("h2",[s._v("浮点数该如何处理？")]),s._v(" "),a("p",[s._v("\n                问：要把小数装入计算机，总共分几步？恭喜，你猜对了，3 步。\n                "),a("ul",[a("li",[s._v("第一步：转换成二进制")]),s._v(" "),a("li",[s._v("第二步：用二进制科学计算法表示")]),s._v(" "),a("li",[s._v("第三步：表示成 IEEE 754 形式")])]),s._v("\n                但第一步和第三步都有可能 "),a("strong",[s._v("丢失精度")]),s._v("。\n            ")]),s._v(" "),a("p",[s._v("\n                回到本文的一开始，\n            ")])])])],1)},[],!1,null,null,null);_.options.__file="precision-of-float-number-in-javascript.vue";n.default=_.exports},"u9/X":function(s,n,t){s.exports=t.p+"assets/bg-20190509-01.5cfaba8.png"}}]);